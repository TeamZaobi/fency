# 凿壁项目文件操作流程

## 元数据管理命令

以下是常用的元数据管理命令：

```bash
# 备份元数据文件
cp html/metadata.json html/metadata.json.backup

# 同步元数据到分发版本
cp html/metadata.json dist/metadata.json

# 检查元数据差异
diff html/metadata.json dist/metadata.json
```

## 页面移动流程

移动页面（如从"研究辅助"更改为"信息化升级"）的完整步骤：

1. 备份元数据：
```bash
cp html/metadata.json html/metadata.json.backup
```

2. 修改HTML文件中的category元标签：
```html
<meta name="category" content="信息化升级">
```

3. 移动文件到新分类目录：
```bash
mv html/pages/research/example.html html/pages/info-upgrade/example.html
```

4. 更新`metadata.json`中相关条目：
   - 更新`id`和`path`字段为新路径
   - 更新`category`字段为新分类
   - 更新`lastModifiedDate`字段为当前时间
   - 更新顶层`lastUpdated`字段

5. 验证JSON格式有效性：
```bash
jq . html/metadata.json > /dev/null && echo "Valid JSON"
```

6. 同步到分发版本：
```bash
cp html/metadata.json dist/metadata.json
```

## 文件操作注意事项

1. 移动文件后，确认原始文件已被删除
2. 更新`metadata.json`后，验证JSON格式的有效性
3. 确保目标目录存在，若不存在需创建：
   ```bash
   mkdir -p html/pages/新分类目录
   ```
4. 移动操作后，确认内容及HTML元标签与新分类一致
5. 检查返回首页链接是否正确（相对路径可能需要调整）

## 验证步骤

每次文件操作后，应执行以下验证：

1. 检查文件移动是否成功：
   ```bash
   ls -la html/pages/目标目录/文件名.html
   ```

2. 确认原文件已删除：
   ```bash
   ls -la html/pages/源目录/文件名.html
   ```

3. 验证元数据中的路径已更新：
   ```bash
   grep -A10 "文件名.html" html/metadata.json
   ```

4. 检查HTML文件中的分类元标签：
   ```bash
   grep -A2 "category" html/pages/目标目录/文件名.html
   ```